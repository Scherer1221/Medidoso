<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenda Semanal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            position: relative; /* Adicionado para ajudar na sobreposição */
        }

        .menu {
            width: 200px;
            background-color: #007bff;
            color: white;
            padding: 15px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            position: absolute;
            top: 0;
            left: -220px; /* Inicialmente fora da tela */
            transition: left 0.3s ease;
            z-index: 1000; /* Para garantir que o menu sobreponha outros elementos */
        }

        .menu ul {
            list-style-type: none;
            padding: 0;
        }

        .menu li {
            margin: 10px 0;
        }

        .menu a {
            color: white;
            text-decoration: none;
            padding: 10px;
            display: block;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .menu a:hover {
            background-color: #0056b3;
        }

        .container {
            flex: 1;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            height: 100vh;
            position: relative; /* Mantido para manter a estrutura */
        }

        h1 {
            text-align: center;
            position: relative;
        }

        .agenda {
            display: flex;
            justify-content: space-between;
            flex-grow: 1;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            position: relative; /* Para manter a estrutura */
        }

        .dia {
            flex: 1;
            padding: 10px;
            display: flex;
            flex-direction: column;
            background-color: #f9f9f9;
            box-sizing: border-box;
            position: relative;
            align-items: center;
            cursor: pointer;
        }

        .dia:not(:last-child) {
            border-right: 1px solid #ddd;
        }

        .dia h2 {
            text-align: center;
            font-size: 19px;
            margin-bottom: 10px;
            margin-top: 30px;
        }

        ul {
            list-style-type: none;
            padding: 0;
            flex-grow: 1;
            text-align: center;
        }

        .data {
            position: absolute;
            top: 10px;
            left: 50%; /* Centraliza horizontalmente */
            transform: translateX(-50%); /* Ajusta a centralização */
            font-weight: bold;
            background-color: #007bff;
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            text-align: center;
            width: 300px;
        }

        .close {
            cursor: pointer;
            color: #007bff;
            margin-top: 10px;
        }

        input[type="text"], input[type="time"], textarea, input[type="file"] {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box; /* Mantém o tamanho da caixa */
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .checkbox-group {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .button-container {
            position: absolute;
            top: 20px;
            left: 20px; /* Posição do botão de menu */
            z-index: 1001; /* Para garantir que o botão esteja acima do menu */
        }

        .download-button {
            position: absolute;
            top: 20px;
            right: 20px; /* Posição do botão de baixar agenda */
            z-index: 1001; /* Para garantir que o botão esteja acima do menu */
        }
    </style>
</head>
<body>
    <div class="button-container">
        <button onclick="toggleMenu()">☰</button> <!-- Somente as três listras -->
    </div>
    <div class="menu" id="menu">
        <ul>
            <li><a href="editUser.html">Perfil</a></li>
            <li><a href="#">Histórico de Agendas</a></li>
            <li><a href="C:\Users\Guilherme\Documents\GitHub\Medidoso\public\index.html">Sair</a></li>
        </ul>
    </div>    
    <div class="container">
        <h1>Agenda de Remédios</h1>
        <button class="download-button" onclick="baixarAgenda()">Baixar Agenda</button>
        <div class="agenda" id="agenda">
            <div class="dia" onclick="abrirModal()">
                <h2>Segunda-feira</h2>
                <span class="data" id="data-segunda"></span>
                <ul id="lista-segunda"></ul>
            </div>
            <div class="dia" onclick="abrirModal()">
                <h2>Terça-feira</h2>
                <span class="data" id="data-terca"></span>
                <ul id="lista-terca"></ul>
            </div>
            <div class="dia" onclick="abrirModal()">
                <h2>Quarta-feira</h2>
                <span class="data" id="data-quarta"></span>
                <ul id="lista-quarta"></ul>
            </div>
            <div class="dia" onclick="abrirModal()">
                <h2>Quinta-feira</h2>
                <span class="data" id="data-quinta"></span>
                <ul id="lista-quinta"></ul>
            </div>
            <div class="dia" onclick="abrirModal()">
                <h2>Sexta-feira</h2>
                <span class="data" id="data-sexta"></span>
                <ul id="lista-sexta"></ul>
            </div>
            <div class="dia" onclick="abrirModal()">
                <h2>Sábado</h2>
                <span class="data" id="data-sabado"></span>
                <ul id="lista-sabado"></ul>
            </div>
            <div class="dia" onclick="abrirModal()">
                <h2>Domingo</h2>
                <span class="data" id="data-domingo"></span>
                <ul id="lista-domingo"></ul>
            </div>
        </div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <h2>Adicionar Remédio</h2>
            <div class="checkbox-group">
                <label><input type="checkbox" id="check-segunda"> S</label>
                <label><input type="checkbox" id="check-terca"> T</label>
                <label><input type="checkbox" id="check-quarta"> Q</label>
                <label><input type="checkbox" id="check-quinta"> Q</label>
                <label><input type="checkbox" id="check-sexta"> S</label>
                <label><input type="checkbox" id="check-sabado"> S</label>
                <label><input type="checkbox" id="check-domingo"> D</label>
            </div>
            <form id="form-remedio" onsubmit="adicionarRemedio(event)">
                <input type="text" id="remedio" placeholder="Nome do remédio" required>
                <input type="time" id="horario" placeholder="Horário" required>
                <textarea id="observacoes" rows="3" placeholder="Observações" style="text-align: center;"></textarea>
                <button type="submit">Adicionar</button>
                <div class="close" onclick="fecharModal()">Fechar</div>
            </form>
        </div>
    </div>

    <script>
        const menu = document.getElementById('menu');

        function toggleMenu() {
            if (menu.style.left === '0px') {
                menu.style.left = '-220px'; // Oculta o menu
            } else {
                menu.style.left = '0px'; // Exibe o menu
            }
        }

        document.addEventListener('click', (event) => {
            const isClickInsideMenu = menu.contains(event.target);
            const isClickInsideButton = document.querySelector('.button-container').contains(event.target);
            const isMenuOpen = menu.style.left === '0px';

            if (!isClickInsideMenu && !isClickInsideButton && isMenuOpen) {
                menu.style.left = '-220px'; // Fecha o menu se o clique foi fora do menu e do botão
            }
        });

        const hoje = new Date();

        function gerarDatasDaSemana() {
            const dias = ['segunda', 'terca', 'quarta', 'quinta', 'sexta', 'sabado', 'domingo'];
            const dataDaSemana = [];

            for (let i = 0; i < 7; i++) {
                const data = new Date(hoje);
                data.setDate(hoje.getDate() + (i - hoje.getDay() + 1) % 7);
                dataDaSemana.push(data.toLocaleDateString('pt-BR'));
            }

            dias.forEach((dia, index) => {
                document.getElementById(`data-${dia}`).innerText = dataDaSemana[index];
            });
        }

        function abrirModal() {
            document.getElementById('modal').style.display = 'flex';
        }

        function fecharModal() {
            document.getElementById('modal').style.display = 'none';
        }

        function adicionarRemedio(event) {
            event.preventDefault();
            const remedio = document.getElementById('remedio').value;
            const horario = document.getElementById('horario').value;
            const observacoes = document.getElementById('observacoes').value;
            const checkboxes = document.querySelectorAll('.checkbox-group input[type="checkbox"]');
            const diasSelecionados = [];

            checkboxes.forEach((checkbox, index) => {
                if (checkbox.checked) {
                    diasSelecionados.push(index);
                }
            });

            diasSelecionados.forEach(dia => {
                const diaNome = ['segunda', 'terca', 'quarta', 'quinta', 'sexta', 'sabado', 'domingo'][dia];
                const lista = document.getElementById(`lista-${diaNome}`);
                const li = document.createElement('li');
                li.textContent = `${remedio} - ${horario} ${observacoes}`;
                lista.appendChild(li);
            });

            fecharModal();
            document.getElementById('form-remedio').reset();
        }

        function baixarAgenda() {
            const element = document.getElementById('agenda');
            html2canvas(element).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF();
                pdf.addImage(imgData, 'PNG', 0, 0);
                pdf.save("agenda.png");
            });
        }

        gerarDatasDaSemana();
    </script>
</body>
</html>
